# 3.2.2 Konstruktory i destruktory
## Czym jest konstruktor?

**Konstruktor** to specjalna metoda klasy, ktÃ³ra jest wywoÅ‚ywana automatycznie, gdy tworzysz nowy obiekt (czyli podczas **instancjowania**). Jego zadaniem jest przygotowanie obiektu do uÅ¼ycia, np. ustawienie poczÄ…tkowych wartoÅ›ci pÃ³l.

W poprzedniej lekcji ustawiaÅ‚eÅ› dane obiektÃ³w za pomocÄ… setterÃ³w po ich stworzeniu, np.:

```cpp
Character player;
player.setName("Aragorn");
player.setHealth(100);
```

To dziaÅ‚a, ale konstruktor pozwala zrobiÄ‡ to wszystko w jednym kroku, podczas tworzenia obiektu. DziÄ™ki temu masz pewnoÅ›Ä‡, Å¼e obiekt od razu jest gotowy do uÅ¼ycia i nie ma â€pÃ³Å‚gotowychâ€ stanÃ³w.

### Jak definiowaÄ‡ konstruktor?

Konstruktor ma tÄ™ samÄ… nazwÄ™ co klasa i nie zwraca Å¼adnej wartoÅ›ci (nawet nie piszemy `void`). MoÅ¼e przyjmowaÄ‡ parametry, aby ustawiÄ‡ poczÄ…tkowe wartoÅ›ci pÃ³l.

#### PrzykÅ‚ad: Klasa `Character` z konstruktorem

```cpp
#include <iostream>
#include <string>

class Character {
private:
    std::string name;
    int health;

public:
    // Konstruktor z parametrami
    Character(std::string initialName, int initialHealth) {
        name = initialName;
        health = initialHealth;
    }

    // Metody dostÄ™powe
    std::string getName() {
        return name;
    }

    int getHealth() {
        return health;
    }

    void setHealth(int newHealth) {
        if (newHealth >= 0) {
            health = newHealth;
        } else {
            health = 0; // Zapobiega ujemnemu zdrowiu
        }
    }

    // Metody zachowaÅ„
    void sayHello() {
        std::cout << "Hello, I am " << name << "!" << std::endl;
    }

    void showStatus() {
        std::cout << name << " has " << health << " health." << std::endl;
    }
};
```

- **`Character(std::string initialName, int initialHealth)`**: To konstruktor. Przyjmuje dwa parametry i ustawia pola `name` i `health`.
- Konstruktor jest `public`, bo musi byÄ‡ dostÄ™pny przy tworzeniu obiektu.

---

## Tworzenie obiektu z konstruktorem

Aby uÅ¼yÄ‡ konstruktora, podajesz wartoÅ›ci w nawiasach podczas instancjowania obiektu:

```cpp
int main() {
    Character player("Aragorn", 100); // Konstruktor ustawia name i health
    player.sayHello();      // Hello, I am Aragorn!
    player.showStatus();    // Aragorn has 100 health.
    return 0;
}
```

- Obiekt `player` jest tworzony z wartoÅ›ciami `"Aragorn"` i `100`.
- Nie musisz juÅ¼ wywoÅ‚ywaÄ‡ setterÃ³w â€“ konstruktor zrobiÅ‚ to za Ciebie.

---

## DomyÅ›lny konstruktor

JeÅ›li nie zdefiniujesz Å¼adnego konstruktora, C++ automatycznie tworzy **domyÅ›lny konstruktor** â€“ metodÄ™ bez parametrÃ³w, ktÃ³ra nie robi nic specjalnego. Na przykÅ‚ad:

```cpp
Character player; // DomyÅ›lny konstruktor jest wywoÅ‚ywany
```

Jednak gdy zdefiniujesz wÅ‚asny konstruktor (jak powyÅ¼ej), domyÅ›lny konstruktor znika. JeÅ›li chcesz, aby klasa miaÅ‚a konstruktor bez parametrÃ³w, musisz go wyraÅºnie dodaÄ‡:

```cpp
class Character {
private:
    std::string name;
    int health;

public:
    // Konstruktor domyÅ›lny
    Character() {
        name = "Unknown";
        health = 50;
    }

    // Konstruktor z parametrami
    Character(std::string initialName, int initialHealth) {
        name = initialName;
        health = initialHealth;
    }
    // ... reszta metod ...
};
```

Teraz moÅ¼esz tworzyÄ‡ obiekty na dwa sposoby:

```cpp
Character unknown;            // DomyÅ›lny: name = "Unknown", health = 50
Character player("Aragorn", 100); // Z parametrami
```

---

## Czym jest destruktor?

**Destruktor** to specjalna metoda klasy, ktÃ³ra jest wywoÅ‚ywana automatycznie, gdy obiekt przestaje istnieÄ‡ (np. gdy wychodzi poza zakres widocznoÅ›ci). Jego zadaniem jest posprzÄ…tanie po obiekcie, np. zwolnienie zasobÃ³w. W C++ destruktor ma nazwÄ™ klasy poprzedzonÄ… tyldÄ… (`~`) i nie przyjmuje parametrÃ³w ani nie zwraca wartoÅ›ci.

### PrzykÅ‚ad z destruktorem

Dodajmy destruktor do klasy `Character`:

```cpp
class Character {
private:
    std::string name;
    int health;

public:
    Character(std::string initialName, int initialHealth) {
        name = initialName;
        health = initialHealth;
        std::cout << name << " has been created!" << std::endl;
    }

    // Destruktor
    ~Character() {
        std::cout << name << " has been destroyed!" << std::endl;
    }

    // ... reszta metod ...
};
```

#### Jak to dziaÅ‚a?
```cpp
int main() {
    Character player("Aragorn", 100);
    player.showStatus(); // Aragorn has 100 health.
    // Koniec main â€“ obiekt player zostaje zniszczony
    return 0;
}
```

Wynik:
```
Aragorn has been created!
Aragorn has 100 health.
Aragorn has been destroyed!
```

- Konstruktor wyÅ›wietla komunikat przy tworzeniu.
- Destruktor wyÅ›wietla komunikat, gdy obiekt przestaje istnieÄ‡ (tutaj po zakoÅ„czeniu `main`).

Na tym etapie destruktor nie musi wiele robiÄ‡, bo nasze obiekty nie uÅ¼ywajÄ… zasobÃ³w wymagajÄ…cych sprzÄ…tania (np. pamiÄ™ci dynamicznej). W grach destruktory sÄ… jednak kluczowe do zwalniania zasobÃ³w, takich jak tekstury czy dÅºwiÄ™ki.

---

## Dlaczego to waÅ¼ne w grach?

W grach, np. w Unreal Engine 5, konstruktory i destruktory sÄ… uÅ¼ywane do:
- **Inicjalizacji**: Ustawianie poczÄ…tkowych wartoÅ›ci postaci, broni czy przeciwnikÃ³w.
- **SprzÄ…tania**: Usuwanie obiektÃ³w, gdy nie sÄ… juÅ¼ potrzebne, aby nie marnowaÄ‡ pamiÄ™ci.

Na przykÅ‚ad klasa postaci moÅ¼e w konstruktorze ustawiÄ‡ zdrowie i pozycjÄ™, a w destruktorze upewniÄ‡ siÄ™, Å¼e postaÄ‡ znika z ekranu, gdy ginie.

---

## Podsumowanie

- **Konstruktor**: Specjalna metoda wywoÅ‚ywana przy tworzeniu obiektu, ustawia poczÄ…tkowe wartoÅ›ci pÃ³l.
- **DomyÅ›lny konstruktor**: Tworzony automatycznie, jeÅ›li nie zdefiniujesz wÅ‚asnego.
- **Destruktor**: Specjalna metoda wywoÅ‚ywana przy niszczeniu obiektu, sprzÄ…ta po nim.
- W grach konstruktory i destruktory pomagajÄ… zarzÄ…dzaÄ‡ obiektami.

Gratulacje! Znasz teraz konstruktory i destruktory w C++. W kolejnych lekcjach rozwiniesz te umiejÄ™tnoÅ›ci, np. uczÄ…c siÄ™ o dziedziczeniu.

---

## Zadania do wykonania

1. **Rozszerz klasÄ™ `Weapon`**:
   - Pola: `name` (`std::string`), `damage` (`int`), ustawione jako `private`.
   - Konstruktor: Przyjmuje `name` i `damage`, ustawia je.
   - Destruktor: WyÅ›wietla "[name] has been destroyed!".
   - Metoda: `showDamage()` (wyÅ›wietla: "[name] deals [damage] damage.").
   - W `main`: StwÃ³rz obiekt i wywoÅ‚aj `showDamage()`.

2. **Rozszerz klasÄ™ `Player`**:
   - Pola: `name` (`std::string`), `health` (`int`), `experience` (`int`), ustawione jako `private`.
   - Konstruktor domyÅ›lny: Ustawia `name` na "Unknown", `health` na 50, `experience` na 0.
   - Konstruktor z parametrami: Przyjmuje `name` i `health`, ustawia `experience` na 0.
   - Metoda: `gainExperience(int amount)` (zwiÄ™ksza doÅ›wiadczenie i wyÅ›wietla: "[name] gained [amount] experience.").
   - W `main`: StwÃ³rz dwa obiekty (z domyÅ›lnym i z parametrami), wywoÅ‚aj `gainExperience(10)`.

3. **Rozszerz klasÄ™ `Character`**:
   - Dodaj konstruktor domyÅ›lny: Ustawia `name` na "Stranger" i `health` na 75.
   - Dodaj destruktor: WyÅ›wietla "[name] has left the game!".
   - Metoda: `attack(std::string target)` (wyÅ›wietla: "[name] attacks [target]!").
   - W `main`: StwÃ³rz dwa obiekty (domyÅ›lny i z parametrami), wywoÅ‚aj `attack` na drugim obiekcie.

---

Eksperymentuj z kodem i baw siÄ™ dobrze! JeÅ›li coÅ› wymaga poprawki, daj znaÄ‡ â€“ lecimy dalej z koksem! ğŸ’ª